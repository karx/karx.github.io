<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=98b01076f4eee0a60ca6e354decb56c9c8e08869" media="screen" type="text/css">
    <link rel="stylesheet" href="/assets/css/print.css" media="print" type="text/css">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>window.fetch polyfill | karx.github.io</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="window.fetch polyfill" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Open channel for karx compute system interactions" />
<meta property="og:description" content="Open channel for karx compute system interactions" />
<link rel="canonical" href="http://localhost:4000/FlutterArsenal/fromgithub/node_modules/whatwg-fetch/" />
<meta property="og:url" content="http://localhost:4000/FlutterArsenal/fromgithub/node_modules/whatwg-fetch/" />
<meta property="og:site_name" content="karx.github.io" />
<script type="application/ld+json">
{"description":"Open channel for karx compute system interactions","@type":"WebPage","headline":"window.fetch polyfill","url":"http://localhost:4000/FlutterArsenal/fromgithub/node_modules/whatwg-fetch/","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>
    <header>
      <div class="inner">
        <a href="http://localhost:4000/">
          <h1>karx.github.io</h1>
        </a>
        <h2>Open channel for karx compute system interactions</h2>
        
          <a href="https://github.com/karx/karx.github.io" class="button"><small>View project on</small> GitHub</a>
        
        
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1 id="windowfetch-polyfill">window.fetch polyfill</h1>

<p>The <code class="highlighter-rouge">fetch()</code> function is a Promise-based mechanism for programmatically making
web requests in the browser. This project is a polyfill that implements a subset
of the standard <a href="https://fetch.spec.whatwg.org">Fetch specification</a>, enough to make <code class="highlighter-rouge">fetch</code> a viable
replacement for most uses of XMLHttpRequest in traditional web applications.</p>

<p>This project adheres to the <a href="http://todogroup.org/opencodeofconduct/#fetch/opensource@github.com">Open Code of Conduct</a>. By participating, you are
expected to uphold this code.</p>

<h2 id="table-of-contents">Table of Contents</h2>

<ul>
  <li><a href="#read-this-first">Read this first</a></li>
  <li><a href="#installation">Installation</a></li>
  <li><a href="#usage">Usage</a>
    <ul>
      <li><a href="#html">HTML</a></li>
      <li><a href="#json">JSON</a></li>
      <li><a href="#response-metadata">Response metadata</a></li>
      <li><a href="#post-form">Post form</a></li>
      <li><a href="#post-json">Post JSON</a></li>
      <li><a href="#file-upload">File upload</a></li>
      <li><a href="#caveats">Caveats</a>
        <ul>
          <li><a href="#handling-http-error-statuses">Handling HTTP error statuses</a></li>
          <li><a href="#sending-cookies">Sending cookies</a></li>
          <li><a href="#receiving-cookies">Receiving cookies</a></li>
          <li><a href="#obtaining-the-response-url">Obtaining the Response URL</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#browser-support">Browser Support</a></li>
</ul>

<h2 id="read-this-first">Read this first</h2>

<ul>
  <li>
    <p>If you believe you found a bug with how <code class="highlighter-rouge">fetch</code> behaves in Chrome or Firefox,
please <strong>don’t open an issue in this repository</strong>. This project is a
<em>polyfill</em>, and since Chrome and Firefox both implement the <code class="highlighter-rouge">window.fetch</code>
function natively, no code from this project actually takes any effect in
these browsers. See <a href="#browser-support">Browser support</a> for detailed
information.</p>
  </li>
  <li>
    <p>If you have trouble <strong>making a request to another domain</strong> (a different
subdomain or port number also constitutes another domain), please familiarize
yourself with all the intricacies and limitations of <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS" title="Cross-origin resource sharing">CORS</a> requests.
Because CORS requires participation of the server by implementing specific
HTTP response headers, it is often nontrivial to set up or debug. CORS is
exclusively handled by the browser’s internal mechanisms which this polyfill
cannot influence.</p>
  </li>
  <li>
    <p>If you have trouble <strong>maintaining the user’s session</strong> or <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet" title="Cross-site request forgery">CSRF</a> protection
through <code class="highlighter-rouge">fetch</code> requests, please ensure that you’ve read and understood the
<a href="#sending-cookies">Sending cookies</a> section. <code class="highlighter-rouge">fetch</code> doesn’t send cookies
unless you ask it to.</p>
  </li>
  <li>
    <p>This project <strong>doesn’t work under Node.js environments</strong>. It’s meant for web
browsers only. You should ensure that your application doesn’t try to package
and run this on the server.</p>
  </li>
  <li>
    <p>If you have an idea for a new feature of <code class="highlighter-rouge">fetch</code>, <strong>submit your feature
requests</strong> to the <a href="https://github.com/whatwg/fetch/issues">specification’s repository</a>.
We only add features and APIs that are part of the <a href="https://fetch.spec.whatwg.org">Fetch specification</a>.</p>
  </li>
</ul>

<h2 id="installation">Installation</h2>

<ul>
  <li>
    <p><code class="highlighter-rouge">npm install whatwg-fetch --save</code>; or</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">bower install fetch</code>; or</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">yarn add whatwg-fetch</code>.</p>
  </li>
</ul>

<p>You will also need a Promise polyfill for <a href="http://caniuse.com/#feat=promises">older browsers</a>.
We recommend <a href="https://github.com/taylorhakes/promise-polyfill">taylorhakes/promise-polyfill</a>
for its small size and Promises/A+ compatibility.</p>

<p>For use with webpack, add this package in the <code class="highlighter-rouge">entry</code> configuration option
before your application entry point:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">entry</span><span class="p">:</span> <span class="p">[</span><span class="s1">'whatwg-fetch'</span><span class="p">,</span> <span class="p">...]</span>
</code></pre></div></div>

<p>For Babel and ES2015+, make sure to import the file:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="s1">'whatwg-fetch'</span>
</code></pre></div></div>

<h2 id="usage">Usage</h2>

<p>For a more comprehensive API reference that this polyfill supports, refer to
https://github.github.io/fetch/.</p>

<h3 id="html">HTML</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">fetch</span><span class="p">(</span><span class="s1">'/users.html'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">text</span><span class="p">()</span>
  <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">body</span>
  <span class="p">})</span>
</code></pre></div></div>

<h3 id="json">JSON</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">fetch</span><span class="p">(</span><span class="s1">'/users.json'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">()</span>
  <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">json</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'parsed json'</span><span class="p">,</span> <span class="nx">json</span><span class="p">)</span>
  <span class="p">}).</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">ex</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'parsing failed'</span><span class="p">,</span> <span class="nx">ex</span><span class="p">)</span>
  <span class="p">})</span>
</code></pre></div></div>

<h3 id="response-metadata">Response metadata</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">fetch</span><span class="p">(</span><span class="s1">'/users.json'</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s1">'Content-Type'</span><span class="p">))</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">headers</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="s1">'Date'</span><span class="p">))</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">)</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<h3 id="post-form">Post form</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">form</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'form'</span><span class="p">)</span>

<span class="nx">fetch</span><span class="p">(</span><span class="s1">'/users'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">method</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
  <span class="na">body</span><span class="p">:</span> <span class="k">new</span> <span class="nx">FormData</span><span class="p">(</span><span class="nx">form</span><span class="p">)</span>
<span class="p">})</span>
</code></pre></div></div>

<h3 id="post-json">Post JSON</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">fetch</span><span class="p">(</span><span class="s1">'/users'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">method</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
  <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">'Content-Type'</span><span class="p">:</span> <span class="s1">'application/json'</span>
  <span class="p">},</span>
  <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
    <span class="na">name</span><span class="p">:</span> <span class="s1">'Hubot'</span><span class="p">,</span>
    <span class="na">login</span><span class="p">:</span> <span class="s1">'hubot'</span><span class="p">,</span>
  <span class="p">})</span>
<span class="p">})</span>
</code></pre></div></div>

<h3 id="file-upload">File upload</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">'input[type="file"]'</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FormData</span><span class="p">()</span>
<span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'file'</span><span class="p">,</span> <span class="nx">input</span><span class="p">.</span><span class="nx">files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'user'</span><span class="p">,</span> <span class="s1">'hubot'</span><span class="p">)</span>

<span class="nx">fetch</span><span class="p">(</span><span class="s1">'/avatars'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">method</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span>
  <span class="na">body</span><span class="p">:</span> <span class="nx">data</span>
<span class="p">})</span>
</code></pre></div></div>

<h3 id="caveats">Caveats</h3>

<p>The <code class="highlighter-rouge">fetch</code> specification differs from <code class="highlighter-rouge">jQuery.ajax()</code> in mainly two ways that
bear keeping in mind:</p>

<ul>
  <li>
    <p>The Promise returned from <code class="highlighter-rouge">fetch()</code> <strong>won’t reject on HTTP error status</strong>
even if the response is an HTTP 404 or 500. Instead, it will resolve normally,
and it will only reject on network failure or if anything prevented the
request from completing.</p>
  </li>
  <li>
    <p>By default, <code class="highlighter-rouge">fetch</code> <strong>won’t send or receive any cookies</strong> from the server,
resulting in unauthenticated requests if the site relies on maintaining a user
session. See <a href="#sending-cookies">Sending cookies</a> for how to opt into cookie
handling.</p>
  </li>
</ul>

<h4 id="handling-http-error-statuses">Handling HTTP error statuses</h4>

<p>To have <code class="highlighter-rouge">fetch</code> Promise reject on HTTP error statuses, i.e. on any non-2xx
status, define a custom response handler:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">checkStatus</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">&gt;=</span> <span class="mi">200</span> <span class="o">&amp;&amp;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">&lt;</span> <span class="mi">300</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">response</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">error</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">statusText</span><span class="p">)</span>
    <span class="nx">error</span><span class="p">.</span><span class="nx">response</span> <span class="o">=</span> <span class="nx">response</span>
    <span class="k">throw</span> <span class="nx">error</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">parseJSON</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">()</span>
<span class="p">}</span>

<span class="nx">fetch</span><span class="p">(</span><span class="s1">'/users'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">checkStatus</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">parseJSON</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'request succeeded with JSON response'</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>
  <span class="p">}).</span><span class="k">catch</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'request failed'</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span>
  <span class="p">})</span>
</code></pre></div></div>

<h4 id="sending-cookies">Sending cookies</h4>

<p>To automatically send cookies for the current domain, the <code class="highlighter-rouge">credentials</code> option
must be provided:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">fetch</span><span class="p">(</span><span class="s1">'/users'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">credentials</span><span class="p">:</span> <span class="s1">'same-origin'</span>
<span class="p">})</span>
</code></pre></div></div>

<p>The “same-origin” value makes <code class="highlighter-rouge">fetch</code> behave similarly to XMLHttpRequest with
regards to cookies. Otherwise, cookies won’t get sent, resulting in these
requests not preserving the authentication session.</p>

<p>For <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS" title="Cross-origin resource sharing">CORS</a> requests, use the “include” value to allow sending credentials to
other domains:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">fetch</span><span class="p">(</span><span class="s1">'https://example.com:1234/users'</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">credentials</span><span class="p">:</span> <span class="s1">'include'</span>
<span class="p">})</span>
</code></pre></div></div>

<h4 id="receiving-cookies">Receiving cookies</h4>

<p>As with XMLHttpRequest, the <code class="highlighter-rouge">Set-Cookie</code> response header returned from the
server is a <a href="https://developer.mozilla.org/en-US/docs/Glossary/Forbidden_header_name">forbidden header name</a> and therefore can’t be programmatically
read with <code class="highlighter-rouge">response.headers.get()</code>. Instead, it’s the browser’s responsibility
to handle new cookies being set (if applicable to the current URL). Unless they
are HTTP-only, new cookies will be available through <code class="highlighter-rouge">document.cookie</code>.</p>

<p>Bear in mind that the default behavior of <code class="highlighter-rouge">fetch</code> is to ignore the <code class="highlighter-rouge">Set-Cookie</code>
header completely. To opt into accepting cookies from the server, you must use
the <code class="highlighter-rouge">credentials</code> option.</p>

<h4 id="obtaining-the-response-url">Obtaining the Response URL</h4>

<p>Due to limitations of XMLHttpRequest, the <code class="highlighter-rouge">response.url</code> value might not be
reliable after HTTP redirects on older browsers.</p>

<p>The solution is to configure the server to set the response HTTP header
<code class="highlighter-rouge">X-Request-URL</code> to the current URL after any redirect that might have happened.
It should be safe to set it unconditionally.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Ruby on Rails controller example</span>
<span class="n">response</span><span class="p">.</span><span class="nf">headers</span><span class="p">[</span><span class="s1">'X-Request-URL'</span><span class="p">]</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="nf">url</span>
</code></pre></div></div>

<p>This server workaround is necessary if you need reliable <code class="highlighter-rouge">response.url</code> in
Firefox &lt; 32, Chrome &lt; 37, Safari, or IE.</p>

<h2 id="browser-support">Browser Support</h2>

<ul>
  <li>Chrome</li>
  <li>Firefox</li>
  <li>Safari 6.1+</li>
  <li>Internet Explorer 10+</li>
</ul>

<p>Note: modern browsers such as Chrome, Firefox, Microsoft Edge, and Safari contain native
implementations of <code class="highlighter-rouge">window.fetch</code>, therefore the code from this polyfill doesn’t
have any effect on those browsers. If you believe you’ve encountered an error
with how <code class="highlighter-rouge">window.fetch</code> is implemented in any of these browsers, you should file
an issue with that browser vendor instead of this project.</p>


        </section>

        <aside id="sidebar">
          

          
            <p class="repo-owner"><a href="https://github.com/karx/karx.github.io">karx.github.io</a> is maintained by <a href="https://github.com/karx">karx</a>.</p>
          

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</p>
        </aside>
      </div>
    </div>

    
  </body>
</html>
